changes from xingcw on dev.