new changes on dev by Simon and xingcw.

